this is broken, if I use double rather than float it will not nan but outputs still a wrong value, not sure what precision tensorflow is using.